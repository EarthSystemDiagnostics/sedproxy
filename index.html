<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Simulation of Sediment Archived Climate Proxy Records.">
<title>Simulation of Sediment Archived Climate Proxy Records • sedproxy</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulation of Sediment Archived Climate Proxy Records">
<meta property="og:description" content="Simulation of Sediment Archived Climate Proxy Records.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">sedproxy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/effect-of-climate-dependent-flux.html">Effect of climate dependent flux.</a>
    <a class="dropdown-item" href="articles/introduction-to-sedproxy.html">Introduction to sedproxy</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="sedproxy-simulation-of-sediment-archived-climate-proxy-records">Sedproxy: Simulation of Sediment Archived Climate Proxy Records.<a class="anchor" aria-label="anchor" href="#sedproxy-simulation-of-sediment-archived-climate-proxy-records"></a>
</h1></div>
<hr>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>sedproxy</code> provides a forward model for sediment archived climate proxies. The forward model and its applications are described in detail in <a href="https://www.clim-past.net/14/1851/2018/cp-14-1851-2018.html" class="external-link">(Dolman and Laepple, CP 2018)</a>.</p>
<p>Please contact Dr Andrew Dolman &lt;<a href="mailto:andrew.dolman@awi.de" class="email">andrew.dolman@awi.de</a>&gt;, or Dr Thomas Laepple &lt;<a href="mailto:tlaepple@awi.de" class="email">tlaepple@awi.de</a>&gt;, at the Alfred-Wegener-Institute, Helmholtz Centre for Polar and Marine Research, Germany, for more information.</p>
<p>This work was supported by German Federal Ministry of Education and Research (BMBF) as Research for Sustainability initiative <a href="https://www.fona.de/" class="external-link">FONA</a> through the <a href="https://www.palmod.de/" class="external-link">PalMod</a> project (FKZ: 01LP1509C).</p>
<p><img src="reference/figures/PalMod_Logo_RGB.png"></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><strong>sedproxy</strong> can be installed directly from github</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"EarthSystemDiagnostics/sedproxy"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="shiny-app">Shiny app<a class="anchor" aria-label="anchor" href="#shiny-app"></a>
</h2>
<p>A Shiny app provides a graphical user interface to the main <code>sedproxy</code> function <code>ClimToProxyClim</code>. Currently this app forward models a proxy from a randomly generated input climate and serves only to illustrate the functionality of <code>sedproxy</code>. The user can alter the parameters of the forward model and observe the results graphically. In future versions it may be possible to load input climates and other input parameters from a file and to save the output.</p>
<p>To run the Shiny app enter the following in the R terminal:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://earthsystemdiagnostics.github.io/sedproxy/">sedproxy</a></span><span class="op">)</span>
<span class="fu"><a href="reference/ShinySedproxy.html">ShinySedproxy</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/sedproxy-screenshot.png"></p>
<p>An online version of the Shiny app is hosted at <a href="https://limnolrgy.shinyapps.io/sedproxy-shiny/" class="external-link">shinyapps.io</a></p>
<p>Below are some brief examples of how to run <code>sedproxy</code> from a script or the command line.</p>
</div>
<div class="section level2">
<h2 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h2>
<p><code>sedproxy</code> includes example data for a single sediment core and location: core number 41 in the Shakun et al. (2012) compilation (MD97-2141, Rosenthal et al. 2003). The climate signal is taken from the <a href="http://www.cgd.ucar.edu/ccr/TraCE/" class="external-link">TraCE-21ka</a> Simulation of Transient Climate Evolution over the last 21,000 years, using the grid cell closest to core MD97-2141. Seasonality of <em>G.ruber</em>, the Foraminifera for which test Mg/Ca ratios were measured, is taken from the model of Fraile et al (2008). Sediment accumulation rates were estimated from the depth and age data associated with core MD97-2141, with a minimum rate of 0.2 * the mean rate.</p>
<p><strong>The MD97-2141 core</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://earthsystemdiagnostics.github.io/sedproxy/">sedproxy</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N41.proxy.details</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span>, format <span class="op">=</span> <span class="st">"markdown"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">key</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Number</td>
<td align="left">41</td>
</tr>
<tr class="even">
<td align="left">ID.no</td>
<td align="left">N41</td>
</tr>
<tr class="odd">
<td align="left">Core</td>
<td align="left">MD97-2141</td>
</tr>
<tr class="even">
<td align="left">Location</td>
<td align="left">Sulu Sea</td>
</tr>
<tr class="odd">
<td align="left">Proxy</td>
<td align="left">Mg/Ca</td>
</tr>
<tr class="even">
<td align="left">Lat</td>
<td align="left">8.78</td>
</tr>
<tr class="odd">
<td align="left">Lon</td>
<td align="left">121.28</td>
</tr>
<tr class="even">
<td align="left">Elevation</td>
<td align="left">-3633.000000</td>
</tr>
<tr class="odd">
<td align="left">Reference</td>
<td align="left">Rosenthal et al., 2003</td>
</tr>
<tr class="even">
<td align="left">Resolution</td>
<td align="left">77.89</td>
</tr>
<tr class="odd">
<td align="left">Calibration.ref</td>
<td align="left">Rosenthal and Lohman, 2002</td>
</tr>
<tr class="even">
<td align="left">Calibration</td>
<td align="left">T = ln(MgCa/0.28)/0.095</td>
</tr>
<tr class="odd">
<td align="left">Foram.sp</td>
<td align="left">G. ruber</td>
</tr>
<tr class="even">
<td align="left">Ref.14C</td>
<td align="left">de Garidel-Thoron et al., 2001, Paleoceanography</td>
</tr>
<tr class="odd">
<td align="left">Notes</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Geo.cluster</td>
<td align="left">Sulu Sea</td>
</tr>
<tr class="odd">
<td align="left">Archive.type</td>
<td align="left">Marine sediment</td>
</tr>
</tbody>
</table>
<p><strong>Input climate signal</strong></p>
<p>The first 5 rows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">N41.t21k.climate</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">-</span><span class="fl">273.15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span>, format <span class="op">=</span> <span class="st">"markdown"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
<th align="right">10</th>
<th align="right">11</th>
<th align="right">12</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">24.71</td>
<td align="right">24.24</td>
<td align="right">24.91</td>
<td align="right">26.07</td>
<td align="right">26.53</td>
<td align="right">27.07</td>
<td align="right">27.40</td>
<td align="right">26.77</td>
<td align="right">26.49</td>
<td align="right">26.49</td>
<td align="right">26.78</td>
<td align="right">26.19</td>
</tr>
<tr class="even">
<td align="right">24.84</td>
<td align="right">24.38</td>
<td align="right">24.68</td>
<td align="right">25.86</td>
<td align="right">26.57</td>
<td align="right">26.52</td>
<td align="right">27.01</td>
<td align="right">27.52</td>
<td align="right">26.63</td>
<td align="right">26.70</td>
<td align="right">26.63</td>
<td align="right">25.82</td>
</tr>
<tr class="odd">
<td align="right">24.69</td>
<td align="right">24.60</td>
<td align="right">25.21</td>
<td align="right">26.00</td>
<td align="right">26.46</td>
<td align="right">26.94</td>
<td align="right">27.00</td>
<td align="right">26.99</td>
<td align="right">26.39</td>
<td align="right">26.45</td>
<td align="right">26.66</td>
<td align="right">25.77</td>
</tr>
<tr class="even">
<td align="right">24.55</td>
<td align="right">24.52</td>
<td align="right">25.34</td>
<td align="right">26.36</td>
<td align="right">26.87</td>
<td align="right">26.75</td>
<td align="right">27.29</td>
<td align="right">26.83</td>
<td align="right">26.55</td>
<td align="right">26.91</td>
<td align="right">26.59</td>
<td align="right">25.84</td>
</tr>
<tr class="odd">
<td align="right">24.62</td>
<td align="right">24.19</td>
<td align="right">24.80</td>
<td align="right">26.02</td>
<td align="right">26.84</td>
<td align="right">26.67</td>
<td align="right">26.99</td>
<td align="right">27.25</td>
<td align="right">26.80</td>
<td align="right">27.01</td>
<td align="right">26.67</td>
<td align="right">25.81</td>
</tr>
</tbody>
</table>
<p><strong>Actual proxy record</strong></p>
<p>Core MD97-2141 (Rosenthal et al. 2003)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">N41.proxy</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"markdown"</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Published.age</th>
<th align="right">Published.temperature</th>
<th align="right">Sed.acc.rate.cm.ka</th>
<th align="right">Proxy.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">4334.286</td>
<td align="right">28.92</td>
<td align="right">36.79</td>
<td align="right">4.346</td>
</tr>
<tr class="even">
<td align="right">4527.429</td>
<td align="right">29.20</td>
<td align="right">36.75</td>
<td align="right">4.460</td>
</tr>
<tr class="odd">
<td align="right">4575.714</td>
<td align="right">29.15</td>
<td align="right">36.77</td>
<td align="right">4.442</td>
</tr>
<tr class="even">
<td align="right">4720.571</td>
<td align="right">28.55</td>
<td align="right">36.77</td>
<td align="right">4.195</td>
</tr>
<tr class="odd">
<td align="right">4913.714</td>
<td align="right">28.33</td>
<td align="right">36.70</td>
<td align="right">4.109</td>
</tr>
<tr class="even">
<td align="right">4994.400</td>
<td align="right">29.44</td>
<td align="right">36.67</td>
<td align="right">4.564</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="function-climtoproxyclim">Function <code>ClimToProxyClim</code>
<a class="anchor" aria-label="anchor" href="#function-climtoproxyclim"></a>
</h2>
<p><code>ClimToProxyClim</code> is the main function in package <code>sedproxy</code>. It simulates a sediment archived proxy from an assumed true climate signal, the sediment accumulation rate, seasonality of the encoding organism/process, and the number of samples per timepoint.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">26052017</span><span class="op">)</span>
<span class="va">clim.in</span> <span class="op">&lt;-</span> <span class="va">N41.t21k.climate</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">N41.t21k.climate</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">-</span> <span class="fl">273.15</span>

<span class="co"># The input climate signal should be a time series object</span>
<span class="co"># The Trace simulation runs to the year 1990 AD, therefore the start time for </span>
<span class="co"># the input climate is -39 years BP</span>
<span class="va">clim.in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">clim.in</span>, start <span class="op">=</span> <span class="op">-</span><span class="fl">39</span><span class="op">)</span>

<span class="va">PFM</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ClimToProxyClim.html">ClimToProxyClim</a></span><span class="op">(</span>clim.signal <span class="op">=</span> <span class="va">clim.in</span>,
                       timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">N41.proxy</span><span class="op">$</span><span class="va">Published.age</span><span class="op">)</span>,
                       calibration.type <span class="op">=</span> <span class="st">"identity"</span>,
                       habitat.weights <span class="op">=</span> <span class="va">N41.G.ruber.seasonality</span>,
                       sed.acc.rate <span class="op">=</span> <span class="va">N41.proxy</span><span class="op">$</span><span class="va">Sed.acc.rate.cm.ka</span>,
                       sigma.meas <span class="op">=</span> <span class="fl">0.23</span>,
                       sigma.ind <span class="op">=</span> <span class="fl">2</span>,
                       n.samples <span class="op">=</span> <span class="fl">30</span>,
                       n.replicates <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PFM</span><span class="op">$</span><span class="va">everything</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 14,045 x 7</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">##    timepoints n.samples replicate stage             value scale       label     </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">##         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;     </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  1       4334        30         1 proxy.bt.sb.sampY  27.7 Proxy units (4) +Alia~</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  2       4527        30         1 proxy.bt.sb.sampY  27.7 Proxy units (4) +Alia~</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  3       4576        30         1 proxy.bt.sb.sampY  27.7 Proxy units (4) +Alia~</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  4       4721        30         1 proxy.bt.sb.sampY  27.6 Proxy units (4) +Alia~</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  5       4914        30         1 proxy.bt.sb.sampY  27.6 Proxy units (4) +Alia~</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  6       4994        30         1 proxy.bt.sb.sampY  27.6 Proxy units (4) +Alia~</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  7       5092        30         1 proxy.bt.sb.sampY  27.7 Proxy units (4) +Alia~</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  8       5156        30         1 proxy.bt.sb.sampY  27.6 Proxy units (4) +Alia~</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  9       5254        30         1 proxy.bt.sb.sampY  27.7 Proxy units (4) +Alia~</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 10       5318        30         1 proxy.bt.sb.sampY  27.7 Proxy units (4) +Alia~</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 14,035 more rows</span></span></code></pre></div>
<p><strong>Simple plotting</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PFM</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="reference/PlotPFMs.html">PlotPFMs</a></span><span class="op">(</span>max.replicates <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Joining, by = c("stage", "scale")</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Scale for 'alpha' is already present. Adding another scale for 'alpha', which</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## will replace the existing scale.</span></span></code></pre></div>
<p><img src="reference/figures/README-default_plot-1.svg" width="100%"></p>
<p><strong>Plot 5 replicates of the final simulated proxy</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PFM</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co">#filter(stage == "simulated.proxy") %&gt;% </span>
  <span class="fu"><a href="reference/PlotPFMs.html">PlotPFMs</a></span><span class="op">(</span><span class="va">.</span>, max.replicates <span class="op">=</span> <span class="fl">5</span>, plot.stages <span class="op">=</span> <span class="st">"simulated.proxy"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Joining, by = c("stage", "scale")</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Scale for 'alpha' is already present. Adding another scale for 'alpha', which</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">## will replace the existing scale.</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_reps-1.svg" width="100%"></p>
<p><strong>Conversion to proxy units</strong></p>
<p>The initial input climate signal can be converted into “proxy units” if a <code>calibration.type</code> is specified. This simulates the Environment -&gt; Sensor stage of the proxy system.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Rescaling noise</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Joining, by = c("stage", "scale")</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Scale for 'alpha' is already present. Adding another scale for 'alpha', which</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="do">## will replace the existing scale.</span></span></code></pre></div>
<p><img src="reference/figures/README-MgCa_plot-1.svg" width="100%"></p>
</div>
<div class="section level2">
<h2 id="literature-cited">Literature cited<a class="anchor" aria-label="anchor" href="#literature-cited"></a>
</h2>
<p>Dolman, A. M. and Laepple, T.: Sedproxy: a forward model for sediment archived climate proxies, Clim. Past Discuss., <a href="https://doi.org/10.5194/cp-2018-13" class="external-link uri">https://doi.org/10.5194/cp-2018-13</a>, in review, 2018.</p>
<p>Fraile, I., Schulz, M., Mulitza, S., &amp; Kucera, M. (2008): Predicting the global distribution of planktonic foraminifera using a dynamic ecosystem model. Biogeosciences, 5: 891–911.</p>
<p>Laepple, T., &amp; Huybers, P. (2013): Reconciling discrepancies between Uk37 and Mg/Ca reconstructions of Holocene marine temperature variability. Earth and Planetary Science Letters, 375: 418–429.</p>
<p>Rosenthal, Y., Oppo, D. W., &amp; Linsley, B. K. (2003): The amplitude and phasing of climate change during the last deglaciation in the Sulu Sea, western equatorial Pacific. Geophys. Res. Lett., 30: 1428.</p>
<p>Shakun, J. D., Clark, P. U., He, F., Marcott, S. A., Mix, A. C., Liu, Z., Otto-Bliesner, B., Schmittner, A., &amp; Bard, E. (2012): Global warming preceded by increasing carbon dioxide concentrations during the last deglaciation. Nature, 484: 49–54.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sedproxy</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Thomas Laepple <br><small class="roles"> Author </small>  </li>
<li>Andrew Dolman <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Thomas Laepple, Andrew Dolman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
